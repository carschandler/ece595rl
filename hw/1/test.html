<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robert (Cars) Chandler – chandl71@purdue.edu">

<title>ECE59500RL HW1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="test_files/libs/clipboard/clipboard.min.js"></script>
<script src="test_files/libs/quarto-html/quarto.js"></script>
<script src="test_files/libs/quarto-html/popper.min.js"></script>
<script src="test_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="test_files/libs/quarto-html/anchor.min.js"></script>
<link href="test_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="test_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="test_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="test_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="test_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ECE59500RL HW1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Robert (Cars) Chandler – chandl71@purdue.edu </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="problem-1" class="level2">
<h2 class="anchored" data-anchor-id="problem-1">Problem 1</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">1.1</h3>
<section id="property-1" class="level4">
<h4 class="anchored" data-anchor-id="property-1">Property 1</h4>
<p>Proving the first property of a norm over a vector space for <span class="math inline">\(\Vert \mathbf{x}
\Vert_\infty\)</span>, we first recall that the L-<span class="math inline">\(\infty\)</span> norm of a vector is defined as the element in the vector with the maximum absolute value. As such,</p>
<p><span class="math display">\[
\Vert \mathbf{x} \Vert_\infty \ge 0, \quad \forall \mathbf{x} \in \mathbb{R}^n
\]</span></p>
<p>since the norm must be an absolute value of some real element, so it must be at least zero:</p>
<p><span class="math display">\[
| r | \ge 0, \quad \forall r \in \mathbb{R}
\]</span></p>
<p>Additionally,</p>
<p><span class="math display">\[
\Vert \mathbf{x} \Vert_\infty = 0 \iff \mathbf{x} = \mathbf{0}
\]</span></p>
<p>Since the only number in <span class="math inline">\(\mathbb{R}\)</span> that has an absolute value of <span class="math inline">\(0\)</span> is <span class="math inline">\(0\)</span>, so for the maximum absolute value (the L-<span class="math inline">\(\infty\)</span> norm) to be 0, all elements of <span class="math inline">\(\mathbf{x}\)</span> must be <span class="math inline">\(0\)</span>.</p>
</section>
<section id="property-2" class="level4">
<h4 class="anchored" data-anchor-id="property-2">Property 2</h4>
<p>To prove the second property, we begin with <span class="math inline">\(\Vert \mathbf{\alpha x}
\Vert_\infty\)</span>, which is the element of the vector <span class="math inline">\(\alpha \mathbf{x}\)</span> with the maximum absolute value. Each element of <span class="math inline">\(\alpha \mathbf{x}\)</span> is <span class="math inline">\(\alpha x_i\)</span>, and it holds that</p>
<p><span class="math display">\[
| \alpha r | = | \alpha | |r|, \quad \forall r \in \mathbb{R}
\]</span></p>
<p>So we can say that the maximum absolute value of <span class="math inline">\(\alpha \mathbf{x}\)</span> is equal to the maximum absolute value of <span class="math inline">\(\mathbf{x}\)</span> multiplied by <span class="math inline">\(| \alpha |\)</span>:</p>
<p><span class="math display">\[
\Vert \mathbf{\alpha x} \Vert_\infty = |\alpha| \Vert \mathbf{x} \Vert _\infty,
\quad \forall \mathbf{x} \in \mathbb{R}^n, \alpha \in \mathbb{R}
\]</span></p>
</section>
<section id="property-3" class="level4">
<h4 class="anchored" data-anchor-id="property-3">Property 3</h4>
<p>To prove the third property, we begin with <span class="math inline">\(\Vert \mathbf{x}_1 + \mathbf{x}_2
\Vert _\infty\)</span>, which is the maximum absolute value of the vector <span class="math inline">\(\mathbf{x}_1
+ \mathbf{x}_2\)</span>. The maximum absolute value of the element-wise sum of two vectors is maximized when the two elements with the largest magnitude in each vector share the same index:</p>
<p><span class="math display">\[
\max \left( \Vert \mathbf{x}_1 + \mathbf{x}_2 \Vert _\infty \right) = \Vert
\mathbf{x}_1 \Vert_\infty  + \Vert \mathbf{x}_2 \Vert_\infty
\]</span></p>
<p>Since this is the maximum value of the LHS, in any other case, we can say that the sum on the right-hand side must be greater than <span class="math inline">\(\Vert
\mathbf{x}_1 + \mathbf{x}_2 \Vert _\infty\)</span>.</p>
<p>So we can say that the maximum absolute value of <span class="math inline">\(\mathbf{x}_1 + \mathbf{x}_2\)</span> is less than or equal to the sum of the maximum absolute values of <span class="math inline">\(\mathbf{x}_1\)</span> and <span class="math inline">\(\mathbf{x}_2\)</span>:</p>
<p><span class="math display">\[
\Vert \mathbf{x}_1 + \mathbf{x}_2 \Vert _\infty \le \Vert
\mathbf{x}_1 \Vert_\infty  + \Vert \mathbf{x}_2 \Vert_\infty , \quad \forall
\mathbf{x}_1, \mathbf{x}_2 \in \mathbb{R}^n
\]</span></p>
</section>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">1.2</h3>
<p>Comparing the L1 and L2 norms, we can square each one to compare them more directly:</p>
<p><span class="math display">\[
\Vert \mathbf{x} \Vert_2^2 = \left(\sqrt{\sum_{i=1}^N | x_i |^2 } \right)^2 = \sum_{i=1}^N | x_i |^2
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\Vert \mathbf{x} \Vert_1^2 = \left(\sum_{i=1}^N | x_i | \right)^2 =
\sum_{i=1}^N |x_i|^2 + 2 * \sum_{i &lt; j} | x_i | |x_j|
\]</span></p>
<p>We can compare the results of these equations directly, and it is apparent that the L1 norm squared has an additional, nonnegative term added, so it must be greater than or equal to the L2 norm squared:</p>
<p><span class="math display">\[
\Vert \mathbf{x} \Vert_1^2 =
\sum_{i=1}^N |x_i|^2 + 2 * \sum_{i &lt; j} | x_i | |x_j| \ge
\sum_{i=1}^N | x_i |^2 =
\Vert \mathbf{x} \Vert_2^2
\]</span></p>
<p>This implies that</p>
<p><span class="math display">\[
\Vert \mathbf{x} \Vert_1 \ge \Vert \mathbf{x} \Vert_2
\]</span></p>
<p>If we then compare the square L2 norm to the square of the L-<span class="math inline">\(\infty\)</span> norm:</p>
<p><span class="math display">\[
\Vert \mathbf{x} \Vert_\infty^2 = \left( \max \{ |x_1|, ..., |x_n| \} \right)^2
\le \sum_{i=1}^N | x_i |^2
= \Vert \mathbf{x} \Vert_2^2
\]</span></p>
<p>since the square of any one element of a vector of positive values must necessarily be less than or equal to a sum of all of those values. This once again implies that</p>
<p><span class="math display">\[
\Vert \mathbf{x} \Vert_2 \ge  \Vert \mathbf{x} \Vert_\infty
\]</span></p>
<p>Combining this with the earlier inequality:</p>
<p><span class="math display">\[
\Vert \mathbf{x} \Vert_\infty \le
\Vert \mathbf{x} \Vert_2 \le  
\Vert \mathbf{x} \Vert_1
\]</span></p>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">1.3</h3>
<p>Given vectors <span class="math inline">\(\mathbf{x}, \mathbf{y} \in \mathbb{R}^n\)</span>, the absolute value of the inner product of these vectors is:</p>
<p><span class="math display">\[
|\langle \mathbf{x}, \mathbf{y} \rangle| = \left| \sum_{i=1}^N x_i y_i \right|
\]</span></p>
<p>which, due to the properties of multiplication and absolute value, is also equivalent to</p>
<p><span class="math display">\[
\sum_{i=1}^N |x_i| |y_i|
\]</span></p>
<p>while the product of the L-<span class="math inline">\(\infty\)</span> and L1 norms is:</p>
<p><span class="math display">\[
\Vert \mathbf{x} \Vert_\infty
\Vert \mathbf{y} \Vert_1
= \max\{ |x_1|, ..., |x_n| \} \sum_{i=1}^N |y_i|
\]</span></p>
<p>If we break these down into an index-by-index basis, then for each <span class="math inline">\(i \ge 1 \in
\mathbb{N}\)</span>, it holds that</p>
<p><span class="math display">\[
|x_i| |y_i| \le x_{\text{absmax}} |y_i|
\]</span></p>
<p>and therefore this also holds across the aggregation of these indices into a sum:</p>
<p><span class="math display">\[
\sum_{i=1}^N |x_i| |y_i| \le \max\{ |x_1|, ..., |x_n| \} \sum_{i=1}^N |y_i|
\]</span></p>
<p>which is equivalent to</p>
<p><span class="math display">\[
| \langle \mathbf{x}, \mathbf{y} \rangle | \le \Vert \mathbf{x} \Vert_\infty \Vert \mathbf{y} \Vert_1
\]</span></p>
</section>
</section>
<section id="problem-2" class="level2">
<h2 class="anchored" data-anchor-id="problem-2">Problem 2</h2>
</section>
<section id="problem-3" class="level2">
<h2 class="anchored" data-anchor-id="problem-3">Problem 3</h2>
<section id="section-3" class="level3">
<h3 class="anchored" data-anchor-id="section-3">3.1</h3>
<p>The state space is</p>
<p><span class="math display">\[
\mathcal{S} = \{ \text{Country}, \text{Jazz}, \text{Rock} \}
\]</span></p>
<p>The initial distribution is the following discrete probability distribution vector, where the indices are in the order Country, Jazz, Rock:</p>
<p><span class="math display">\[
\mu_0 = \{ 0, 1, 0 \}
\]</span></p>
<p>The transition matrix, with rows and columns in the order Country, Jazz, Rock, is:</p>
<p><span class="math display">\[
P = \begin{bmatrix}
0 &amp; 0.5 &amp; 0.5 \\
0.3 &amp; 0.1 &amp; 0.6 \\
0.2 &amp; 0 &amp; 0.8 \\
\end{bmatrix}
\]</span></p>
</section>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4">3.2</h2>
<p>Let <span class="math inline">\(C, J, R\)</span> be the states corresponding to the respective genres. The probability of starting with Jazz each time is <span class="math inline">\(1\)</span>, so we just represent our initial state in probability space with a <span class="math inline">\(1\)</span> and we multiply the probability of each transition after that.</p>
<section id="a" class="level3">
<h3 class="anchored" data-anchor-id="a">3.2.a</h3>
<p>The probability of transitioning from Country to Country <span class="math inline">\(\mathbb{P}(C | C) =
0\)</span>, so the probability of the sequence is <span class="math inline">\(0\)</span>.</p>
</section>
<section id="b" class="level3">
<h3 class="anchored" data-anchor-id="b">3.2.b</h3>
<p><span class="math display">\[
1 \cdot \mathbb{P}(J | R) \mathbb{P}(R | R) \mathbb{P}(C | R) \mathbb{P} (J | C)
= 1 \cdot 0.6 \cdot 0.8 \cdot 0.2 \cdot 0.5 = 0.048
\]</span></p>
</section>
<section id="c" class="level3">
<h3 class="anchored" data-anchor-id="c">3.2.c</h3>
<p><span class="math display">\[
\begin{aligned}
&amp;1 \cdot \mathbb{P}(J | R) \mathbb{P}(C | R) \mathbb{P}(R | C) \mathbb{P} (C | R)
\ldots \mathbb{P}(R | C) \mathbb{P}(C | R) \\
= &amp;\mathbb{P}(J | R) \prod_{i=1}^m \mathbb{P}(C | R)  \prod_{i=1}^{m-1} \mathbb{P}(R | C) \\
= &amp;\mathbb{P}(J | R) \mathbb{P}(C | R)^m  \mathbb{P}(R | C)^{m-1} \\
= &amp;0.6 \cdot 0.2^m  0.5^{m-1} \\
\end{aligned}
\]</span></p>
</section>
</section>
<section id="todo-check-above" class="level1">
<h1>TODO: check above</h1>
<section id="d" class="level3">
<h3 class="anchored" data-anchor-id="d">3.2.d</h3>
<p>As the final product repeats more and more as <span class="math inline">\(m\)</span> approaches infinity, the product will approach <span class="math inline">\(0\)</span> since the fractions raised to the <span class="math inline">\(m\)</span> and <span class="math inline">\(m-1\)</span> power will both approach <span class="math inline">\(0\)</span> since they are less than one and raised to an infinite power.</p>
</section>
<section id="section-5" class="level2">
<h2 class="anchored" data-anchor-id="section-5">3.3</h2>
<p>We can find this using the transition matrix raised to the <span class="math inline">\(t=2\)</span> power:</p>
<div id="1a4eb530" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>mu0 <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>trans_matrix <span class="op">=</span> np.array([</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">0</span> , <span class="fl">0.5</span> , <span class="fl">0.5</span>],</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  [<span class="fl">0.3</span> , <span class="fl">0.1</span> , <span class="fl">0.6</span>],</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  [<span class="fl">0.2</span> , <span class="dv">0</span> , <span class="fl">0.8</span> ],</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>mu2 <span class="op">=</span> mu0 <span class="op">@</span> trans_matrix <span class="op">@</span> trans_matrix</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>mu2 <span class="op">=</span> mu0 <span class="op">@</span> np.linalg.matrix_power(trans_matrix, <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[
\mu_0 P^2 = \begin{bmatrix}0 &amp; 1 &amp; 0\end{bmatrix}
\begin{bmatrix}
0 &amp; 0.5 &amp; 0.5 \\
0.3 &amp; 0.1 &amp; 0.6 \\
0.2 &amp; 0 &amp; 0.8 \\
\end{bmatrix}^2
=[0.17475728155339787, 0.09708737864077728, 0.7281553398058259]
\]</span></p>
<p>Where the entries in the vector correspond to the probability of playing Country, Jazz, and Rock at <span class="math inline">\(t=2\)</span>, respectively.</p>
</section>
<section id="section-6" class="level2">
<h2 class="anchored" data-anchor-id="section-6">3.4</h2>
<p>We can calculate the steady-state distribution <span class="math inline">\(\bar{\mu}\)</span> using a similar code as above, repeatedly applying the transition matrix until some convergence threshold is met. We will set the steady-state condition to be reached when a difference of less than 1e-8 is reached for all values in the distribution:</p>
<div id="62240f4e" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>state_distribution <span class="op">=</span> mu0</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>difference_criterion <span class="op">=</span> <span class="fl">1e-8</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(<span class="va">True</span>):</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  t <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  old_state_distribution <span class="op">=</span> state_distribution.copy()</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  state_distribution <span class="op">=</span> state_distribution <span class="op">@</span> trans_matrix</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> np.<span class="bu">all</span>(np.<span class="bu">abs</span>(state_distribution <span class="op">-</span> old_state_distribution) <span class="op">&lt;</span> difference_criterion):</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The steady-state distribution is approximately <span class="math display">\[
\bar{\mu} = [0.17475728268372312, 0.09708737729711539, 0.7281553400191619]
\]</span></p>
<p>and the convergence criterion is met at time <span class="math inline">\(t = 17\)</span>.</p>
</section>
<section id="section-7" class="level2">
<h2 class="anchored" data-anchor-id="section-7">3.5</h2>
<p>We first re-define our stationary distribution since the new requirement is to extend to 100 timesteps, which is further than the previous convergence condition reached. We set it to be the distribution at <span class="math inline">\(t=110\)</span> since this is past the final value required for plotting and the distribution should be effectively unchanging at this point.</p>
<div id="b5f1ac46" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>steady_state <span class="op">=</span> mu0 <span class="op">@</span> np.linalg.matrix_power(trans_matrix, <span class="dv">110</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>trans_matrices <span class="op">=</span> np.array([np.linalg.matrix_power(trans_matrix, i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">101</span>)])</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>l1_norms <span class="op">=</span> np.linalg.norm(mu0 <span class="op">@</span> trans_matrices <span class="op">-</span> steady_state, <span class="bu">ord</span><span class="op">=</span><span class="dv">1</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>ax.plot(l1_norms)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"t"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r"$\Vert \mu_t - \bar{\mu} \Vert_1$"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="test_files/figure-html/cell-4-output-1.png" width="600" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-8" class="level2">
<h2 class="anchored" data-anchor-id="section-8">3.6</h2>
<p>Based on the steady-state distribution, we expect Rock to be played most often, because given any sufficiently large <span class="math inline">\(t\)</span>-value, the probability of the state being Rock is fixed and is much higher than the other two states. This makes sense given that Rock has such a high probability of transitioning to itself.</p>
</section>
<section id="problem-6" class="level2">
<h2 class="anchored" data-anchor-id="problem-6">Problem 6</h2>
<section id="section-9" class="level3">
<h3 class="anchored" data-anchor-id="section-9">6.1</h3>
<p>The scenario can be described as a POMDP with reward defined by the tuple <span class="math inline">\(\mu =
(\mu_0, \mathcal{S}, \mathcal{O}, \mathcal{Z}, \mathcal{A}, \mathcal{P},
\mathcal{R}, \gamma)\)</span></p>
<p>Additionally, we define the following “helper” sets and a function to map between the movies available and the genres of those movies. We could describe all elements of the MDP without these by writing out all possible combinations, but these help to minimize the amount of writing necessary:</p>
<p><span class="math display">\[
\begin{gathered}
G = \{ A, H, C \} \\
M = \{ A, B, C, D \} \\
\mathcal{G}: M \to G^n, \quad n \in \{1, 2, 3\}
\end{gathered}
\]</span></p>
<p><span class="math inline">\(G\)</span> is the set of genres available, <span class="math inline">\(M\)</span> is the set of movies available, and <span class="math inline">\(\mathcal{G}\)</span> describes which genres apply for a given movie.</p>
<p><span class="math inline">\(\mathcal{S} = \{ s_A, s_H, s_C \}\)</span> where each state corresponds to the user’s desired genre, which is either Action, Horror, or Comedy, respectively.</p>
<p><span class="math inline">\(\mathcal{O} = \{ o_L, o_D \}\)</span> where each observation corresponds to whether the user submitted a “Like” or a “Dislike” after viewing the movie, which partially reveals the underlying state: the user’s true genre preference. Instead of observing their true preference, we just observe whether the selected movie aligned with their true preference or not, as shown.</p>
<p><span class="math inline">\(\mathcal{Z} = \mathcal{Z}(s, a): \mathcal{S} \times \mathcal{A} \to
\Delta(\mathcal{O})\)</span></p>
<p><span class="math display">\[
\mathcal{O}(s, a) = \begin{cases}
\left[ 1, 0 \right] \text{ when } (s_i, a_j) \text{ where } i \in G, i \in \mathcal{G}(j), j \in M \\
\left[ 0, 1 \right] \text{ when } (s_i, a_j) \text{ where } i \in G, i \notin \mathcal{G}(j), j \in M \\
\end{cases}
\]</span></p>
<p>In english, the observation takes a state (the user’s genre preference) and an action (which movie the system suggested), and returns an observation. The observation returned depends on whether the genre of the movie (described by the function <span class="math inline">\(\mathcal{G}\)</span>, which maps a value in the set of available movies to one or more genres which apply to that movie) aligns with the desired genre of the user. If the genre of the selected movie aligns with the user’s true preference, the observation will certainly be a “Like”, <span class="math inline">\(o_L\)</span>, and if it does not align, then it will certainly be a “Dislike”, <span class="math inline">\(o_D\)</span>.</p>
<p><span class="math inline">\(\mu_0 = \left[  \frac{1}{3},  \frac{1}{3},  \frac{1}{3} \right]\)</span> where the order of the indices is Action, Horror, Comedy; the same as for <span class="math inline">\(\mathcal{S}\)</span>.</p>
<p><span class="math inline">\(\mathcal{A} = \{ a_A, a_B, a_C, a_D \}\)</span> which are actions corresponding to which movie the system recommends to the user.</p>
<p><span class="math inline">\(\mathcal{P} = \mathcal{P}(s, a): \mathcal{S} \times \mathcal{A} \to \Delta
(\mathcal{S})\)</span> where the function can be described piecewise as:</p>
<p><span class="math display">\[
\mathcal{P}(s, a) = \begin{cases}
\left[ 1, 0, 0 \right], s = s_A, A \notin \mathcal{G}(a) \\
\left[ 0, 1, 0 \right], s = s_H, H \notin \mathcal{G}(a) \\
\left[ 0, 0, 1 \right], s = s_C, C \notin \mathcal{G}(a) \\
\left[ 0, 0.5, 0.5 \right], s = s_A, A \in \mathcal{G}(a) \\
\left[ 0.5, 0, 0.5 \right], s = s_H, H \in \mathcal{G}(a) \\
\left[ 0.5, 0.5, 0 \right], s = s_C, C \in \mathcal{G}(a) \\
\end{cases}
\]</span></p>
<p>When the user’s genre preference is not one of the genres of the movie chosen by the previous action, the user’s genre preference remains the same with probability 1. If one of the movie’s genres is the user’s preference, then the next genre preference will be one of the other two genres with equal probability (0.5) for each genre.</p>
<p><span class="math inline">\(\mathcal{R} = \mathcal{R}(s, a): \mathcal{S} \times \mathcal{A} \to r \in [-1, 1]\)</span></p>
<p>No additional information has been given about the reward aside from its bounds.</p>
<p><span class="math inline">\(\gamma = 0.95\)</span></p>
</section>
<section id="section-10" class="level3">
<h3 class="anchored" data-anchor-id="section-10">6.2</h3>
<!-- ```{dot} -->
<!-- digraph { -->
<!--   A -> H [label="a_A, 0.4*0.5 = 0.2"] -->
<!--   A -> C [label="a_A, 0.4*0.5 = 0.2"] -->
<!--   A -> H [label="a_B, 0.4*0.5 = 0.2"] -->
<!--   A -> C [label="a_B, 0.4*0.5 = 0.2"] -->
<!--   A -> A [label="a_D, 0.2"] -->
<!--   H -> H [label="a_A, 0.25"] -->
<!--   H -> A [label="a_B, 0.25*0.5=0.125"] -->
<!--   H -> C [label="a_B, 0.25*0.5=0.125"] -->
<!--   H -> A [label="a_C, 0.25*0.5=0.125"] -->
<!--   H -> C [label="a_C, 0.25*0.5=0.125"] -->
<!--   H -> A [label="a_D, 0.25*0.5=0.125"] -->
<!--   H -> C [label="a_D, 0.25*0.5=0.125"] -->
<!--   C -> C [label="a_B=0.1"] -->
<!--   C -> A [label="a_C=0.9*0.5=0.45"] -->
<!--   C -> H [label="a_C=0.9*0.5=0.45"] -->
<!-- } -->
<!-- ``` -->
<p>The transition-based graph of the recommendation strategy is shown below where the nodes correspond to the different states and the edges are labeled with the actions taken in the transitions they represent along with the probability of taking that respective action/transition:</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<svg width="672" height="480" viewbox="0.00 0.00 608.05 324.46" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 320.46)">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-320.46 604.05,-320.46 604.05,4 -4,4"></polygon>
<!-- A -->
<g id="node1" class="node">
<title>A</title>
<ellipse fill="none" stroke="black" cx="289.55" cy="-238.86" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="289.55" y="-234.66" font-family="Times,serif" font-size="14.00">A</text>
</g>
<!-- A&#45;&gt;A -->
<g id="edge5" class="edge">
<title>A:n-&gt;A:n</title>
<path fill="none" stroke="black" d="M289.55,-256.86C314.55,-265.52 314.55,-282.86 289.55,-282.86 268.26,-282.86 265.1,-270.29 280.07,-261.2"></path>
<polygon fill="black" stroke="black" points="281.92,-264.21 289.55,-256.86 279,-257.84 281.92,-264.21"></polygon>
<text text-anchor="middle" x="289.55" y="-303.86" font-family="Times,serif" font-size="14.00">D</text>
<text text-anchor="middle" x="289.55" y="-287.06" font-family="Times,serif" font-size="14.00">0.2</text>
</g>
<!-- H -->
<g id="node2" class="node">
<title>H</title>
<ellipse fill="none" stroke="black" cx="159.55" cy="-133.26" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="159.55" y="-129.06" font-family="Times,serif" font-size="14.00">H</text>
</g>
<!-- A&#45;&gt;H -->
<g id="edge1" class="edge">
<title>A:nw-&gt;H</title>
<path fill="none" stroke="black" d="M274.55,-254.86C253.14,-276.27 26.25,-226.27 7.05,-202.86 -2.42,-191.31 -2.25,-180.94 7.05,-169.26 21.26,-151.42 82.42,-141.93 122.84,-137.5"></path>
<polygon fill="black" stroke="black" points="123.29,-140.97 132.88,-136.46 122.57,-134.01 123.29,-140.97"></polygon>
<text text-anchor="middle" x="16.3" y="-190.26" font-family="Times,serif" font-size="14.00">A</text>
<text text-anchor="middle" x="16.3" y="-173.46" font-family="Times,serif" font-size="14.00">0.2</text>
</g>
<!-- A&#45;&gt;H -->
<g id="edge3" class="edge">
<title>A:nw-&gt;H</title>
<path fill="none" stroke="black" d="M274.55,-254.86C271.67,-257.74 117.41,-252.09 80.05,-202.86 71.02,-190.96 71.89,-181.76 80.05,-169.26 89.74,-154.4 107.3,-145.81 123.46,-140.86"></path>
<polygon fill="black" stroke="black" points="124.51,-144.2 133.26,-138.23 122.69,-137.44 124.51,-144.2"></polygon>
<text text-anchor="middle" x="89.3" y="-190.26" font-family="Times,serif" font-size="14.00">B</text>
<text text-anchor="middle" x="89.3" y="-173.46" font-family="Times,serif" font-size="14.00">0.2</text>
</g>
<!-- C -->
<g id="node3" class="node">
<title>C</title>
<ellipse fill="none" stroke="black" cx="333.55" cy="-27.66" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="333.55" y="-23.46" font-family="Times,serif" font-size="14.00">C</text>
</g>
<!-- A&#45;&gt;C -->
<g id="edge2" class="edge">
<title>A-&gt;C</title>
<path fill="none" stroke="black" d="M309.85,-226.5C318.89,-220.53 328.95,-212.44 335.55,-202.86 363.29,-162.57 359.59,-145.67 366.55,-97.26 368.68,-82.47 372.06,-77.54 366.55,-63.66 364.47,-58.42 361.19,-53.51 357.49,-49.12"></path>
<polygon fill="black" stroke="black" points="359.98,-46.65 350.55,-41.82 354.91,-51.48 359.98,-46.65"></polygon>
<text text-anchor="middle" x="372.3" y="-137.46" font-family="Times,serif" font-size="14.00">A</text>
<text text-anchor="middle" x="372.3" y="-120.66" font-family="Times,serif" font-size="14.00">0.2</text>
</g>
<!-- A&#45;&gt;C -->
<g id="edge4" class="edge">
<title>A-&gt;C:ne</title>
<path fill="none" stroke="black" d="M316.98,-238.53C378.03,-239.39 522.13,-237.6 552.55,-202.86 593.31,-156.31 594.11,-109.49 552.55,-63.66 524.1,-32.28 400.07,-69.8 356.88,-49.35"></path>
<polygon fill="black" stroke="black" points="358.78,-46.4 348.55,-43.66 354.84,-52.19 358.78,-46.4"></polygon>
<text text-anchor="middle" x="591.3" y="-137.46" font-family="Times,serif" font-size="14.00">B</text>
<text text-anchor="middle" x="591.3" y="-120.66" font-family="Times,serif" font-size="14.00">0.2</text>
</g>
<!-- H&#45;&gt;A -->
<g id="edge7" class="edge">
<title>H-&gt;A</title>
<path fill="none" stroke="black" d="M152.11,-150.73C146.53,-165.86 141.61,-188.11 153.05,-202.86 165.2,-218.51 216.64,-228.37 252.77,-233.5"></path>
<polygon fill="black" stroke="black" points="252.59,-237.01 262.97,-234.88 253.53,-230.07 252.59,-237.01"></polygon>
<text text-anchor="middle" x="169.3" y="-190.26" font-family="Times,serif" font-size="14.00">B</text>
<text text-anchor="middle" x="169.3" y="-173.46" font-family="Times,serif" font-size="14.00">0.125</text>
</g>
<!-- H&#45;&gt;A -->
<g id="edge9" class="edge">
<title>H-&gt;A</title>
<path fill="none" stroke="black" d="M174.94,-148.09C190.89,-162.26 216.71,-184.72 240.05,-202.86 247.22,-208.43 255.18,-214.22 262.58,-219.45"></path>
<polygon fill="black" stroke="black" points="260.72,-222.42 270.93,-225.28 264.73,-216.68 260.72,-222.42"></polygon>
<text text-anchor="middle" x="255.3" y="-190.26" font-family="Times,serif" font-size="14.00">C</text>
<text text-anchor="middle" x="255.3" y="-173.46" font-family="Times,serif" font-size="14.00">0.125</text>
</g>
<!-- H&#45;&gt;A -->
<g id="edge11" class="edge">
<title>H-&gt;A</title>
<path fill="none" stroke="black" d="M186.62,-134.2C214.29,-135.72 256.41,-142.65 279.55,-169.26 289.31,-180.47 291.98,-196.84 292.13,-210.77"></path>
<polygon fill="black" stroke="black" points="288.63,-210.72 291.83,-220.82 295.62,-210.93 288.63,-210.72"></polygon>
<text text-anchor="middle" x="307.3" y="-190.26" font-family="Times,serif" font-size="14.00">D</text>
<text text-anchor="middle" x="307.3" y="-173.46" font-family="Times,serif" font-size="14.00">0.125</text>
</g>
<!-- H&#45;&gt;H -->
<g id="edge6" class="edge">
<title>H:ne-&gt;H:e</title>
<path fill="none" stroke="black" d="M174.55,-148.26C200.22,-161.26 236.55,-161.26 236.55,-140.76 236.55,-123.46 212.82,-120.76 195.39,-128.14"></path>
<polygon fill="black" stroke="black" points="193.46,-125.22 186.55,-133.26 196.96,-131.28 193.46,-125.22"></polygon>
<text text-anchor="middle" x="248.8" y="-137.46" font-family="Times,serif" font-size="14.00">A</text>
<text text-anchor="middle" x="248.8" y="-120.66" font-family="Times,serif" font-size="14.00">0.25</text>
</g>
<!-- H&#45;&gt;C -->
<g id="edge8" class="edge">
<title>H:sw-&gt;C</title>
<path fill="none" stroke="black" d="M144.55,-117.26C121.22,-93.92 92.99,-123.54 73.05,-97.26 64.02,-85.36 63.22,-74.9 73.05,-63.66 101.58,-31.04 231.16,-27.55 296.15,-27.93"></path>
<polygon fill="black" stroke="black" points="296.34,-31.43 306.37,-28.02 296.41,-24.43 296.34,-31.43"></polygon>
<text text-anchor="middle" x="89.3" y="-84.66" font-family="Times,serif" font-size="14.00">B</text>
<text text-anchor="middle" x="89.3" y="-67.86" font-family="Times,serif" font-size="14.00">0.125</text>
</g>
<!-- H&#45;&gt;C -->
<g id="edge10" class="edge">
<title>H-&gt;C</title>
<path fill="none" stroke="black" d="M173.49,-117.68C188.67,-102.5 214.26,-78.84 240.05,-63.66 258.58,-52.75 281.1,-44.2 299.4,-38.28"></path>
<polygon fill="black" stroke="black" points="300.57,-41.58 309.08,-35.26 298.49,-34.89 300.57,-41.58"></polygon>
<text text-anchor="middle" x="255.3" y="-84.66" font-family="Times,serif" font-size="14.00">C</text>
<text text-anchor="middle" x="255.3" y="-67.86" font-family="Times,serif" font-size="14.00">0.125</text>
</g>
<!-- H&#45;&gt;C -->
<g id="edge12" class="edge">
<title>H:se-&gt;C:n</title>
<path fill="none" stroke="black" d="M174.55,-117.26C208.14,-83.66 237.31,-119 279.55,-97.26 291.66,-91.02 320.24,-71.46 330.12,-55.47"></path>
<polygon fill="black" stroke="black" points="333.55,-56.25 333.55,-45.66 326.95,-53.94 333.55,-56.25"></polygon>
<text text-anchor="middle" x="339.3" y="-84.66" font-family="Times,serif" font-size="14.00">D</text>
<text text-anchor="middle" x="339.3" y="-67.86" font-family="Times,serif" font-size="14.00">0.125</text>
</g>
<!-- C&#45;&gt;A -->
<g id="edge14" class="edge">
<title>C-&gt;A:ne</title>
<path fill="none" stroke="black" d="M359.21,-33.85C375.54,-38.63 395.45,-47.52 405.55,-63.66 413.47,-76.32 407.15,-82.41 405.55,-97.26 400.41,-145.01 408.21,-162.25 382.55,-202.86 345.77,-261.04 326.03,-267.77 312.8,-261.13"></path>
<polygon fill="black" stroke="black" points="314.63,-258.12 304.55,-254.86 310.39,-263.69 314.63,-258.12"></polygon>
<text text-anchor="middle" x="415.8" y="-137.46" font-family="Times,serif" font-size="14.00">C</text>
<text text-anchor="middle" x="415.8" y="-120.66" font-family="Times,serif" font-size="14.00">0.45</text>
</g>
<!-- C&#45;&gt;H -->
<g id="edge15" class="edge">
<title>C:nw-&gt;H:se</title>
<path fill="none" stroke="black" d="M318.55,-43.66C268.03,-94.17 206.32,-10.09 159.05,-63.66 149.17,-74.85 154.22,-83.13 159.05,-97.26 160.81,-102.41 166.37,-105.4 170.73,-108.01"></path>
<polygon fill="black" stroke="black" points="167.5,-109.35 174.55,-117.26 173.97,-106.68 167.5,-109.35"></polygon>
<text text-anchor="middle" x="170.8" y="-84.66" font-family="Times,serif" font-size="14.00">C</text>
<text text-anchor="middle" x="170.8" y="-67.86" font-family="Times,serif" font-size="14.00">0.45</text>
</g>
<!-- C&#45;&gt;C -->
<g id="edge13" class="edge">
<title>C:s-&gt;C:se</title>
<path fill="none" stroke="black" d="M333.55,-9.66C359.22,3.34 410.55,3.34 410.55,-11.16 410.55,-23.96 382.23,-25.46 357.94,-16.69"></path>
<polygon fill="black" stroke="black" points="359.12,-13.39 348.55,-12.66 356.36,-19.82 359.12,-13.39"></polygon>
<text text-anchor="middle" x="419.3" y="-31.86" font-family="Times,serif" font-size="14.00">B</text>
<text text-anchor="middle" x="419.3" y="-15.06" font-family="Times,serif" font-size="14.00">0.1</text>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>The given policy is stationary as it does only depend on the user’s current genre preference rather than their past or future ones. It is also a stochastic policy rather than a deterministic one as the action taken is chosen with some degree of randomness as indicated by the probability values on the edges/transitions in the graph.</p>
</section>
<section id="section-11" class="level3">
<h3 class="anchored" data-anchor-id="section-11">6.3</h3>
<!-- ```{dot} -->
<!-- digraph { -->
<!--   A -> B [label=""] -->
<!-- } -->
<!-- ``` -->
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>